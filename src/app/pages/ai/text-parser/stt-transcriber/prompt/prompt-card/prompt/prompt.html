<ion-card>
  <ion-card-content>
    <!-- Browser Support Check -->
    @if (errorMessage()) {
      <div class="alert alert-warning">
        <ion-icon name="warning-outline" class="me-2"></ion-icon>
        {{ errorMessage() }}
      </div>
    } @else {
      <!-- Recording Controls -->
      <div class="d-flex justify-content-center mb-3">
        @if (!isRecording()) {
          <ion-button
            fill="solid"
            color="primary"
            (click)="startRecording()"
            [disabled]="isProcessing()">
            <ion-icon slot="start" name="mic-outline"></ion-icon>
            Start Recording
          </ion-button>
        } @else {
          <ion-button
            fill="solid"
            color="danger"
            (click)="stopRecording()">
            <ion-icon slot="start" name="stop-circle-outline"></ion-icon>
            Stop Recording
          </ion-button>
        }
      </div>

      <!-- Recording Status -->
      @if (isRecording()) {
        <div class="text-center mb-3">
          <div class="spinner-border spinner-border-sm text-primary me-2"></div>
          <span class="text-muted">Listening... Speak clearly into your microphone</span>
        </div>
      }

      <!-- Processing Status -->
      @if (isProcessing()) {
        <div class="text-center mb-3">
          <div class="spinner-border spinner-border-sm text-info me-2"></div>
          <span class="text-muted">Processing speech...</span>
        </div>
      }

      <!-- Transcription Results -->
      @if (transcribedText() || interimText()) {
        <div class="border border-1 rounded border-secondary m-2 p-2">
          <h6 class="text-primary">
            <ion-icon name="text-outline" class="me-2"></ion-icon>
            Live Transcription
          </h6>

          <!-- Final text -->
          @if (transcribedText()) {
            <div class="mb-2">
              <strong>Transcribed Text:</strong>
              <div class="transcribed-text">{{ transcribedText() }}</div>
            </div>
          }

          <!-- Interim text -->
          @if (interimText()) {
            <div class="text-muted">
              <strong>Processing:</strong> {{ interimText() }}
            </div>
          }
        </div>
      }

      <!-- Instructions -->
      @if (!isRecording() && !transcribedText() && !interimText()) {
        <div class="text-center text-muted mt-3">
          <ion-icon name="information-circle-outline" size="large"></ion-icon>
          <p class="mb-0">Click "Start Recording" and begin speaking. Make sure your browser supports speech recognition and microphone access is enabled.</p>
        </div>
      }
    }
  </ion-card-content>
</ion-card>
