import{a as me}from"./chunk-HC3BP3NQ.js";import{a as ue}from"./chunk-FBIAD76D.js";import{a as ge}from"./chunk-OPGM3H6O.js";import{$ as n,Aa as h,D as A,Ea as a,Fa as o,G as i,M,Sb as j,Ub as z,V as C,Va as q,Vb as W,W as y,Wb as J,Y as B,Yb as K,Z as E,_ as p,_b as Q,aa as l,ba as v,bc as X,cc as Y,dc as Z,eb as N,fa as V,fb as L,ga as _,gb as G,ha as g,hc as ee,ic as te,jc as ie,kb as x,kc as ne,lb as O,lc as ae,mb as P,nb as F,nc as oe,pb as T,q as b,rb as $,rc as le,sa as s,sb as U,sc as re,t as f,ta as d,tb as R,tc as se,u as S,ua as u,uc as pe,vc as ce,wc as de,y as D,yb as H}from"./chunk-FBZGSWPW.js";import"./chunk-47I4HTL2.js";import"./chunk-O5ACUAGF.js";import"./chunk-BNVQK7VA.js";import"./chunk-RWLIDNVN.js";import"./chunk-6Y6JXPO3.js";import"./chunk-CJTBSKBM.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-GLN724OH.js";import"./chunk-KDQ633UG.js";import"./chunk-XS642VVA.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{i as k}from"./chunk-C4LRBQUY.js";var he=(r,t)=>t.code,ve=(r,t)=>t.value;function fe(r,t){r&1&&(n(0,"ion-item"),v(1,"ion-spinner"),n(2,"ion-label",4),s(3),a(4,"transloco"),l()()),r&2&&(i(3),d(o(4,1,"common.loading")))}function Se(r,t){r&1&&v(0,"ion-icon",11)}function xe(r,t){if(r&1){let e=V();n(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),s(3),a(4,"transloco"),l()(),n(5,"ion-card-content")(6,"form",5),_("ngSubmit",function(){f(e);let c=g(2);return S(c.saveUsageSettings())}),n(7,"ion-item")(8,"ion-toggle",6),s(9),a(10,"transloco"),l()(),n(11,"ion-text",7)(12,"small"),s(13),a(14,"transloco"),l()(),n(15,"ion-item"),v(16,"ion-input",8),a(17,"transloco"),l(),n(18,"ion-text",7)(19,"small"),s(20),a(21,"transloco"),l()(),n(22,"div",9)(23,"ion-button",10),C(24,Se,1,0,"ion-icon",11),s(25),a(26,"transloco"),a(27,"transloco"),l(),n(28,"ion-button",12),_("click",function(){f(e);let c=g(2);return S(c.resetToDefaults())}),s(29),a(30,"transloco"),l(),n(31,"ion-button",13),_("click",function(){f(e);let c=g(2);return S(c.addMockData())}),s(32),a(33,"transloco"),l(),n(34,"ion-button",14),_("click",function(){f(e);let c=g(2);return S(c.resetDatabase())}),s(35),a(36,"transloco"),l()()()()()}if(r&2){let e=g(2);i(3),d(o(4,13,"settings.usageSettings")),i(3),p("formGroup",e.usageForm),i(3),d(o(10,15,"settings.showDismissedBatteries")),i(4),d(o(14,17,"settings.showDismissedBatteriesDescription")),i(3),p("label",h(o(17,19,"settings.batteryAlertDays"))),i(4),d(o(21,21,"settings.batteryAlertDaysDescription")),i(3),p("disabled",e.isSaving()||e.usageForm.invalid),i(),y(e.isSaving()?24:-1),i(),u(" ",e.isSaving()?o(26,23,"common.saving"):o(27,25,"common.save")," "),i(4),u(" ",o(30,27,"settings.resetToDefaults")," "),i(3),u(" ",o(33,29,"settings.addMockData")," "),i(3),u(" ",o(36,31,"settings.resetDatabase")," ")}}function be(r,t){if(r&1&&(n(0,"ion-select-option",16),v(1,"img",19),s(2),l()),r&2){let e=t.$implicit;p("value",e.code),i(),p("src","/flags/"+e.code+".svg",A)("alt",e.name+" flag"),i(),u(" ",e.name," ")}}function Ce(r,t){if(r&1&&(n(0,"ion-select-option",16),v(1,"ion-icon",20),s(2),l()),r&2){let e=t.$implicit;p("value",e.value),i(),p("name",e.value==="light"?"sunny":"moon"),i(),u(" ",e.label," ")}}function ye(r,t){if(r&1&&(n(0,"ion-select-option",16),v(1,"ion-icon",20),s(2),l()),r&2){let e=t.$implicit;p("value",e.value),i(),p("name",e.value==="default"?"square":"diamond"),i(),u(" ",e.label," ")}}function Te(r,t){r&1&&v(0,"ion-icon",11)}function we(r,t){if(r&1){let e=V();n(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),s(3),a(4,"transloco"),l()(),n(5,"ion-card-content")(6,"form",5),_("ngSubmit",function(){f(e);let c=g(2);return S(c.saveAppSettings())}),n(7,"ion-item")(8,"ion-select",15),a(9,"transloco"),a(10,"transloco"),B(11,be,3,4,"ion-select-option",16,he),l()(),n(13,"ion-text",7)(14,"small"),s(15),a(16,"transloco"),l()(),n(17,"ion-item")(18,"ion-select",17),a(19,"transloco"),a(20,"transloco"),B(21,Ce,3,3,"ion-select-option",16,ve),l()(),n(23,"ion-text",7)(24,"small"),s(25),a(26,"transloco"),l()(),n(27,"ion-item")(28,"ion-select",18),a(29,"transloco"),a(30,"transloco"),B(31,ye,3,3,"ion-select-option",16,ve),l()(),n(33,"ion-text",7)(34,"small"),s(35),a(36,"transloco"),l()(),n(37,"div",9)(38,"ion-button",10),C(39,Te,1,0,"ion-icon",11),s(40),a(41,"transloco"),a(42,"transloco"),l(),n(43,"ion-button",12),_("click",function(){f(e);let c=g(2);return S(c.resetToDefaults())}),s(44),a(45,"transloco"),l()()()()()}if(r&2){let e=g(2);i(3),d(o(4,21,"settings.appSettings")),i(3),p("formGroup",e.appForm),i(2),p("label",h(o(9,23,"settings.language")))("placeholder",h(o(10,25,"common.select"))),i(3),E(e.availableLanguages),i(4),d(o(16,27,"settings.languageDescription")),i(3),p("label",h(o(19,29,"settings.defaultTheme")))("placeholder",h(o(20,31,"common.select"))),i(3),E(e.availableThemes),i(4),d(o(26,33,"settings.defaultThemeDescription")),i(3),p("label",h(o(29,35,"settings.styleTheme")))("placeholder",h(o(30,37,"common.select"))),i(3),E(e.availableStyleThemes),i(4),d(o(36,39,"settings.styleThemeDescription")),i(3),p("disabled",e.isSaving()||e.appForm.invalid),i(),y(e.isSaving()?39:-1),i(),u(" ",e.isSaving()?o(41,41,"common.saving"):o(42,43,"common.save")," "),i(4),u(" ",o(45,45,"settings.resetToDefaults")," ")}}function Ie(r,t){if(r&1&&(C(0,xe,37,33,"ion-card"),C(1,we,46,47,"ion-card")),r&2){let e=g();y(e.activeTab()==="usage"?0:-1),i(),y(e.activeTab()==="app"?1:-1)}}var w=class w{sqlite=b(me);themeService=b(ue);toast=b(ge);alertController=b(le);transloco=b(N);activeTab=D("app");isLoading=D(!1);isSaving=D(!1);usageForm=new F({showDismissedBatteries:new T(!1,[x.required]),batteryAlertDays:new T(30,[x.required,x.min(1)])});appForm=new F({language:new T("en",[x.required]),defaultTheme:new T("light",[x.required]),styleTheme:new T("default",[x.required])});availableLanguages=[{code:"en",name:"English"},{code:"it",name:"Italiano"}];availableThemes=[{value:"light",label:"Light"},{value:"dark",label:"Dark"}];availableStyleThemes=[{value:"default",label:"Default"},{value:"liquid-glass",label:"Liquid Glass"}];async ngOnInit(){await this.loadSettings()}async loadSettings(){this.isLoading.set(!0);try{let t=await this.sqlite.getSettings();if(t.length>0){let I=t[0];this.usageForm.patchValue({showDismissedBatteries:I.showDismissedBatteries,batteryAlertDays:I.batteryAlertDays})}let e=this.themeService.currentThemeValue,m=this.themeService.styleThemeValue,c=t.length>0?t[0].language:"en";this.appForm.patchValue({defaultTheme:e,styleTheme:m,language:c})}catch(t){console.error("Error loading settings:",t)}finally{this.isLoading.set(!1)}}setActiveTab(t){this.activeTab.set(t)}onTabChange(t){let e=t.detail.value;(e==="usage"||e==="app")&&this.setActiveTab(e)}async saveUsageSettings(){if(!this.usageForm.invalid){this.isSaving.set(!0);try{let t=this.usageForm.value;await this.sqlite.updateSettings(t.showDismissedBatteries,t.batteryAlertDays),this.toast.showUsageSettingsSaved()}catch(t){console.error("Error saving usage settings:",t),this.toast.showSettingsSaveError()}finally{this.isSaving.set(!1)}}}async saveAppSettings(){if(!this.appForm.invalid){this.isSaving.set(!0);try{let t=this.appForm.value;t.defaultTheme&&this.themeService.setTheme(t.defaultTheme),t.styleTheme&&this.themeService.setStyleTheme(t.styleTheme),t.language&&(await this.sqlite.updateSettings(!1,void 0,void 0,t.language),console.log("Language preference saved:",t.language)),this.toast.showAppSettingsSaved()}catch(t){console.error("Error saving app settings:",t),this.toast.showSettingsSaveError()}finally{this.isSaving.set(!1)}}}async addMockData(){await(await this.alertController.create({header:"Confirm Mock Data",message:"Are you sure you want to add mock data? This will add new data to your database.",buttons:[{text:"Cancel",role:"cancel"},{text:"Add",handler:async()=>{await this.sqlite.fillWithMockData(),this.toast.showSuccess("Mock data added successfully!")}}]})).present()}async resetDatabase(){await(await this.alertController.create({header:"Confirm Database Reset",message:"Are you sure you want to reset the database? This will delete all your data.",buttons:[{text:"Cancel",role:"cancel"},{text:"Reset",handler:async()=>{await this.sqlite.resetDatabase(),this.toast.showSuccess("Database reset successfully!")}}]})).present()}resetToDefaults(){this.usageForm.patchValue({showDismissedBatteries:!1}),this.appForm.patchValue({language:"en",defaultTheme:"light"})}};k(w,"\u0275fac",function(e){return new(e||w)}),k(w,"\u0275cmp",M({type:w,selectors:[["app-settings"]],decls:17,vars:11,consts:[[1,"ion-padding"],["mode","ios",3,"ionChange","value"],["value","usage"],["value","app"],[1,"ion-padding-start"],[3,"ngSubmit","formGroup"],["formControlName","showDismissedBatteries"],["color","medium",1,"ion-padding-start"],["type","number","formControlName","batteryAlertDays","min","1","placeholder","30","labelPlacement","stacked",3,"label"],[1,"ion-padding-top"],["type","submit","expand","block",3,"disabled"],["name","hourglass","slot","start"],["fill","outline","expand","block","type","button",3,"click"],["fill","outline","expand","block","type","button","color","warning",3,"click"],["fill","outline","expand","block","type","button","color","danger",3,"click"],["formControlName","language","interface","popover",3,"label","placeholder"],[3,"value"],["formControlName","defaultTheme","interface","popover",3,"label","placeholder"],["formControlName","styleTheme","interface","popover",3,"label","placeholder"],[2,"margin-right","8px","width","20px","height","15px",3,"src","alt"],[2,"margin-right","8px",3,"name"]],template:function(e,m){e&1&&(n(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),s(3),a(4,"transloco"),l()()(),n(5,"ion-content",0)(6,"ion-segment",1),_("ionChange",function(I){return m.onTabChange(I)}),n(7,"ion-segment-button",2)(8,"ion-label"),s(9),a(10,"transloco"),l()(),n(11,"ion-segment-button",3)(12,"ion-label"),s(13),a(14,"transloco"),l()()(),C(15,fe,5,3,"ion-item")(16,Ie,2,2),l()),e&2&&(i(3),d(o(4,5,"settings.title")),i(3),p("value",m.activeTab()),i(3),d(o(10,7,"settings.usageSettings")),i(4),d(o(14,9,"settings.appSettings")),i(2),y(m.isLoading()?15:16))},dependencies:[q,H,$,O,P,U,R,G,X,oe,ae,Q,pe,ee,Z,Y,ce,te,j,re,z,J,K,W,de,se,ne,ie,L],styles:["ion-title[_ngcontent-%COMP%], ion-card-title[_ngcontent-%COMP%]{color:var(--ion-text-color, #000000)}"]}));var _e=w;export{_e as Settings};
