import{a as z}from"./chunk-VSGTTJ62.js";import{a as G}from"./chunk-VTUANHFU.js";import{a as J}from"./chunk-YT5JQ4XB.js";import{a as K}from"./chunk-KLMFB6R5.js";import"./chunk-HC5WD3P2.js";import{a as H}from"./chunk-HC3BP3NQ.js";import"./chunk-3O5BBAB7.js";import"./chunk-QUJFQN2Y.js";import"./chunk-ZJDRVGAW.js";import"./chunk-2WUTNZ77.js";import"./chunk-533A5ZN6.js";import"./chunk-OV6OYDEQ.js";import"./chunk-QNI7GNQ2.js";import"./chunk-WHRUHNE4.js";import"./chunk-JNK3GQ7R.js";import"./chunk-FP7WQM7J.js";import"./chunk-PXWF6NOB.js";import"./chunk-GHQHBVAT.js";import"./chunk-LBMIQEU6.js";import"./chunk-WI5MSH4N.js";import"./chunk-OWWVQ6JQ.js";import"./chunk-CKP3SGE2.js";import"./chunk-R4YTUUEB.js";import{a as $}from"./chunk-OPGM3H6O.js";import{$ as a,Ea as m,Fa as c,G as l,M as D,V as x,Va as I,W as T,_ as g,_a as E,_b as A,aa as r,ba as M,bb as w,bc as q,cc as O,dc as k,eb as L,fa as h,fb as V,g as S,ga as b,gb as N,ha as s,hc as F,jc as U,lc as P,nc as R,q as u,sa as d,t as y,ta as B,u as C,uc as j,va as v,y as p}from"./chunk-FBZGSWPW.js";import"./chunk-47I4HTL2.js";import"./chunk-O5ACUAGF.js";import"./chunk-BNVQK7VA.js";import"./chunk-RWLIDNVN.js";import"./chunk-6Y6JXPO3.js";import"./chunk-CJTBSKBM.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-GLN724OH.js";import"./chunk-KDQ633UG.js";import"./chunk-XS642VVA.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{i as f}from"./chunk-C4LRBQUY.js";function X(i,t){i&1&&(a(0,"ion-item"),M(1,"ion-spinner"),a(2,"ion-label",6),d(3),m(4,"transloco"),r()()),i&2&&(l(3),B(c(4,1,"common.loading")))}function Y(i,t){if(i&1){let e=h();a(0,"app-battery-list",11),b("dataChanged",function(){y(e);let o=s(2);return C(o.refreshData())}),r()}if(i&2){let e=s(2);g("batteries",e.batteries())("brands",e.brands())("series",e.series())("types",e.types())}}function Z(i,t){if(i&1){let e=h();a(0,"app-brand-list",12),b("dataChanged",function(){y(e);let o=s(2);return C(o.refreshData())}),r()}if(i&2){let e=s(2);g("brands",e.brands())}}function ee(i,t){if(i&1){let e=h();a(0,"app-series-list",13),b("dataChanged",function(){y(e);let o=s(2);return C(o.refreshData())}),r()}if(i&2){let e=s(2);g("series",e.series())}}function te(i,t){if(i&1){let e=h();a(0,"app-type-list",14),b("dataChanged",function(){y(e);let o=s(2);return C(o.refreshData())}),r()}if(i&2){let e=s(2);g("types",e.types())}}function ie(i,t){if(i&1&&x(0,Y,1,4,"app-battery-list",7)(1,Z,1,1,"app-brand-list",8)(2,ee,1,1,"app-series-list",9)(3,te,1,1,"app-type-list",10),i&2){let e=s();T(e.activeTab()==="batteries"?0:e.activeTab()==="brands"?1:e.activeTab()==="series"?2:e.activeTab()==="types"?3:-1)}}var _=class _{sqlite=u(H);router=u(w);toast=u($);transloco=u(L);routerSubscription;activeTab=p("batteries");batteries=p([]);brands=p([]);series=p([]);types=p([]);isLoading=p(!1);async ngOnInit(){await this.loadAllData(),this.routerSubscription=this.router.events.pipe(S(t=>t instanceof E)).subscribe(t=>{this.updateActiveTabFromUrl(t.urlAfterRedirects)}),this.updateActiveTabFromUrl(this.router.url)}ngOnDestroy(){var t;(t=this.routerSubscription)==null||t.unsubscribe()}updateActiveTabFromUrl(t){let e=t.split("?")[0].split("/").pop()||"batteries";this.activeTab.set(e)}async loadAllData(){this.isLoading.set(!0);try{let[t,e,n,o]=await Promise.all([this.sqlite.getBatteries(),this.sqlite.getBrands(),this.sqlite.getSeries(),this.sqlite.getTypes()]);console.log("Loading data:",{batteries:t.length,brands:e.length,series:n.length,types:o.length}),this.batteries.set(t),this.brands.set(e),this.series.set(n),this.types.set(o)}catch(t){console.error("Error loading data:",t)}finally{this.isLoading.set(!1)}}setActiveTab(t){this.activeTab.set(t)}onTabChange(t){this.router.navigate([`/manage/${t.detail.value}`])}async refreshData(){await this.loadAllData()}};f(_,"\u0275fac",function(e){return new(e||_)}),f(_,"\u0275cmp",D({type:_,selectors:[["app-battery-management"]],decls:25,vars:21,consts:[[1,"ion-padding"],["mode","ios",3,"ionChange","value"],["value","batteries","routerLink","/manage/batteries"],["value","brands","routerLink","/manage/brands"],["value","series","routerLink","/manage/series"],["value","types","routerLink","/manage/types"],[1,"ion-padding-start"],[3,"batteries","brands","series","types"],[3,"brands"],[3,"series"],[3,"types"],[3,"dataChanged","batteries","brands","series","types"],[3,"dataChanged","brands"],[3,"dataChanged","series"],[3,"dataChanged","types"]],template:function(e,n){e&1&&(a(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d(3),m(4,"transloco"),r()()(),a(5,"ion-content",0)(6,"ion-segment",1),b("ionChange",function(W){return n.onTabChange(W)}),a(7,"ion-segment-button",2)(8,"ion-label"),d(9),m(10,"transloco"),r()(),a(11,"ion-segment-button",3)(12,"ion-label"),d(13),m(14,"transloco"),r()(),a(15,"ion-segment-button",4)(16,"ion-label"),d(17),m(18,"transloco"),r()(),a(19,"ion-segment-button",5)(20,"ion-label"),d(21),m(22,"transloco"),r()()(),x(23,X,5,3,"ion-item")(24,ie,4,1),r()),e&2&&(l(3),B(c(4,11,"nav.manageBatteries")),l(3),g("value",n.activeTab()),l(3),v("",c(10,13,"nav.batteries")," (",n.batteries().length,")"),l(4),v("",c(14,15,"battery-management.brands")," (",n.brands().length,")"),l(4),v("",c(18,17,"battery-management.series")," (",n.series().length,")"),l(4),v("",c(22,19,"battery-management.types")," (",n.types().length,")"),l(2),T(n.isLoading()?23:24))},dependencies:[I,O,q,R,P,A,j,F,k,N,U,z,G,J,K,V],encapsulation:2}));var Q=_;export{Q as BatteryManagement};
